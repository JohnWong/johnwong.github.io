<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Code Jam 2010 Round 1A Problem C</title>
  <meta name="description" content=""> 
  
  <script src="//libs.baidu.com/jquery/1.7.2/jquery.min.js"></script>
  <script src="//libs.baidu.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="//libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css">
  <link rel="stylesheet" href="//libs.baidu.com/bootstrap/3.0.3/css/bootstrap-theme.min.css">
  
  <script src="/js/common.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/pygments.css">
  <link rel="stylesheet" href="/css/github-markdown.css">
  <link rel="canonical" href="/past/2013/09/20/code-jam-2010-round-1a-problem-c.html">
</head>

  <body>

    <header class="navbar navbar-responsive-top jw-docs-nav" id="top" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".jw-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/" class="navbar-brand">
        <img class="gravatar" alt="John Wong" src="http://gravatar.duoshuo.com/avatar/135dee388c0976f500748a64960038ee?s=88">
        <span class="name">John Wong</span>
      </a>
    </div>
    <nav class="collapse navbar-collapse jw-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        
        <li class="">
          <a href="/category/mobile.html">mobile</a>
        </li>
        
        <li class="">
          <a href="/category/security.html">security</a>
        </li>
        
        <li class="">
          <a href="/category/showcase.html">showcase</a>
        </li>
        
        <li class="active">
          <a href="/category/past.html">past</a>
        </li>
        
        <!-- <li>
          <a href="#">Bookmarks</a>
        </li> -->
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/about.html" target="_blank">About</a>
        </li>
      </ul>
    </nav>
  </div>
</header>
    
    <div class="page-content">
      <div class="wrapper">
        
  

  

  

  
    
  

<div class="container post-middle">
  <div class="row">
    <div class="col-md-9" role="main">
      <div class="post">
        
        <h1 class="post-big-title">
          Code Jam 2010 Round 1A Problem C
        </h1>
        <div class="post-author">
          <a class="category" href="/category/past.html"><span class="glyphicon glyphicon-time"></span>past</a> | <span id="author" class="author"></span> • Sep 20, 2013
        </div>
        <div class="markdown-body">
          <h3>Problem C. Number Game</h3>

<h4>Problem</h4>

<p>Arya and Bran are playing a game. Initially, two positive integers A and B are written on a blackboard. The players take turns, starting with Arya. On his or her turn, a player can replace A with A - k<em>B for any positive integer k, or replace B with B - k</em>A for any positive integer k. The first person to make one of the numbers drop to zero or below loses.</p>

<p>For example, if the numbers are initially (12, 51), the game might progress as follows:</p>

<p>Arya replaces 51 with 51 - 3<em>12 = 15, leaving (12, 15) on the blackboard.
Bran replaces 15 with 15 - 1</em>12 = 3, leaving (12, 3) on the blackboard.
Arya replaces 12 with 12 - 3<em>3 = 3, leaving (3, 3) on the blackboard.
Bran replaces one 3 with 3 - 1</em>3 = 0, and loses.
We will say (A, B) is a winning position if Arya can always win a game that starts with (A,B) on the blackboard, no matter what Bran does.
Given four integers A1, A2, B1, B2, count how many winning positions (A, B) there are with A1 ≤ A ≤ A2 and B1 ≤ B ≤ B2.</p>

<h4>Input</h4>

<p>The first line of the input gives the number of test cases, T. T test cases follow, one per line. Each line contains the four integers A1, A2, B1, B2, separated by spaces.</p>

<h4>Output</h4>

<p>For each test case, output one line containing &quot;Case #x: y&quot;, where x is the case number (starting from 1), and y is the number of winning positions (A, B) with A1 ≤ A ≤ A2 and B1≤ B ≤ B2.</p>

<h4>Limits</h4>

<p>1 ≤ T ≤ 100. 
1 ≤ A1 ≤ A2 ≤ 1,000,000.
1 ≤ B1 ≤ B2 ≤ 1,000,000.</p>

<h4>Small dataset</h4>

<p>A2 - A1 ≤ 30.
B2 - B1 ≤ 30.</p>

<h4>Large dataset</h4>

<p>A2 - A1 ≤ 999,999.
B2 - B1 ≤ 999,999.</p>

<p>No additional constraints.</p>

<h4>Sample</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">Input  

3
5 5 8 8
11 11 2 2
1 6 1 6

Output

Case #1: 0
Case #2: 1
Case #3: 20
</code></pre></div>
<p>解题思路：终于把动态规划理解的差不多了，用动态规划写了解法，做了一些优化，可以解决小数据量。但是大数据量效率太差等不到解出来的时刻了。看了解析才知道这是又玩起组合游戏。高效解决问题基于2点：
1. If A ≥ 2B, then (A, B) is a winning position.
设k使得0&lt;A-kB&lt;B，那么(A-kB, B)如果必败，那么我们就减去kB。如果(A-kB, B)必胜，那么我们见减去(k-1)B，这样对方只能再减去B，我们得到(A-kB, B)，必胜
2. Theorem: (A, B) is a winning position if and only if A ≥ φ B.</p>

<p>论证过程是：</p>

<p>Round 1: (A, B). If A ≥ 2B, i.e., A/B ≥ 2, then (A, B) is winning.<br>
Round 2: (B, A-B). If B ≥ 2(A-B), i.e., A/B ≤ 3/2, then (A, B) is losing.<br>
Round 3: (A-B, 2B-A). If A-B ≥ 2(2B-A), i.e., A/B ≥ 5/3, then (A, B) is wining.<br>
Round 4: (2B-A, 2A-3B). If 2B-A ≥ 2(2A-3B), i.e., A/B ≤ 8/5, then (A, B) is losing.<br>
And so on.<br>
1,2,3,5,8是斐波那契数列，A/B是后项与前项的比值，即φ = (1 + √ 5) / 2。已知A，找出B中小于等于A/φ或者大于等于A*φ的部分。</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">C</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
    <span class="kt">double</span> <span class="n">ratio</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">C</span><span class="o">;</span> <span class="n">c</span><span class="o">++)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">a2</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">double</span> <span class="n">up</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">ratio</span><span class="o">;</span>
            <span class="kt">double</span> <span class="n">down</span> <span class="o">=</span> <span class="n">i</span> <span class="o">/</span> <span class="n">ratio</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">b1</span> <span class="o">&gt;=</span> <span class="n">up</span> <span class="o">||</span> <span class="n">b2</span> <span class="o">&lt;=</span> <span class="n">down</span><span class="o">)</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">b1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">b1</span> <span class="o">&lt;=</span> <span class="n">down</span><span class="o">)</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="n">max</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">floor</span><span class="o">(</span><span class="n">down</span><span class="o">)</span> <span class="o">-</span> <span class="n">b1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">b2</span> <span class="o">&gt;=</span> <span class="n">up</span><span class="o">)</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="n">max</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">b2</span> <span class="o">-</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">ceil</span><span class="o">(</span><span class="n">up</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;Case #%d: %d&quot;</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">count</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
        </div>
        
        <div id="disqus_head" class="disqus_head">
  <h2>Comments</h2>
</div>
<div id="disqus_thread" class="disqus_thread"></div>
<script type="text/javascript" async=true src="//johnwong.disqus.com/embed.js"></script>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      </div>
    </div>
    <div class="col-md-3 index-right">

      <img class="gravatar index-gravatar" alt="John Wong" src="http://gravatar.duoshuo.com/avatar/135dee388c0976f500748a64960038ee?s=240">
<h1 class="index-me">
  <span>John Wong <a href="https://github.com/JohnWong">@Github</a></span>
</h1>
<div class="vcard-stats">
  <a class="vcard-stat" href="https://github.com/JohnWong/followers">
    <strong class="vcard-stat-count">20</strong> followers
  </a>
  <a class="vcard-stat" href="https://github.com/stars/JohnWong">
    <strong class="vcard-stat-count">43</strong> Starred
  </a>
  <a class="vcard-stat" href="https://github.com/JohnWong/following">
    <strong class="vcard-stat-count">10</strong> Following
  </a>
  <div class="cf"></div>
</div>

    </div>
  </div>
</div>
      </div>
    </div>
    
    <footer class="jw-docs-footer" role="contentinfo">
  <div class="container">
    <div class="jw-docs-social">
      <ul class="jw-docs-social-buttons">
        <li class="github-btn">
          <iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=JohnWong&type=follow&count=true&size=small" width="165" height="20" title="Follow on GitHub"></iframe>
        </li>
        <li class="github-btn">
          <iframe class="github-btn" src="http://pytool.sinaapp.com/wb-btn?user=2180280355&type=follow&count=true&size=small&encoding=utf-8" width="160" height="20" title="Follow on Weibo"></iframe>
        </li>
        <!-- 解决linkedin抓数据500错误前关闭按钮
                    <li class="github-btn">
                        <iframe class="github-btn" src="http://pytool.sinaapp.com/in-btn?user=xiaozhe-huang/4b/204/71b&count=true&size=small&encoding=utf-8" width="202" height="20" title="Follow on Weibo"></iframe>
                    </li>
                -->
      </ul>
    </div>
    <p>自豪地采用自己做的博客系统
      <br class="footer-desc-endline">with the help of <a href="http://getbootstrap.com/">Twitter Bootstrap</a> & <a href="https://github.com/jekyll/jekyll">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>
      <p>
        <ul class="jw-docs-footer-links muted">
          <li>© 2014 • <a href="https://github.com/JohnWong">John Wong</a> <span class="rss-subscribe"> | subscribe <a href="/feed.xml">via RSS</a></span>
          </li>
        </ul>
  </div>
  <div style="display:none">
    <div style="display: none !important"
<span id='cnzz_stat_icon_1252918306'></span>
<script src='http://s23.cnzz.com/z_stat.php?id=1252918306' type='text/javascript'></script>
    <script>
(function(i, s, o, g, r, a, m) {
  i['GoogleAnalyticsObject'] = r;
  i[r] = i[r] || function() {
    (i[r].q = i[r].q || []).push(arguments)
  }, i[r].l = 1 * new Date();
  a = s.createElement(o),
    m = s.getElementsByTagName(o)[0];
  a.async = 1;
  a.src = g;
  m.parentNode.insertBefore(a, m)
})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

ga('create', 'UA-53121297-1', 'auto');
ga('send', 'pageview');
</script>
  </div>
</footer>

  </body>

</html>
