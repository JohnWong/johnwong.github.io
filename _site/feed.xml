<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>John Wong&#39;s Blog</title>
    <description></description>
    <link>/</link>
    <atom:link href="/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Wed, 04 Feb 2015 16:19:58 +0800</pubDate>
    <lastBuildDate>Wed, 04 Feb 2015 16:19:58 +0800</lastBuildDate>
    <generator>Jekyll v2.4.0</generator>
    
      <item>
        <title>今日公交</title>
        <description>&lt;h1&gt;&lt;img src=&quot;https://raw.githubusercontent.com/JohnWong/bus-today/master/Docs/icon.png&quot; alt=&quot;应用图标&quot;&gt; BusRider&lt;/h1&gt;

&lt;p&gt;精准的实时公交车应用，包含通知中心插件，查看实时数据更轻松。&lt;/p&gt;

&lt;h3&gt;功能&lt;/h3&gt;

&lt;h4&gt;通知中心&lt;/h4&gt;

&lt;p&gt;随时随地查看实时公交数据。不再需要解锁手机-&amp;gt;打开应用，只需要打开通知中心。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/JohnWong/bus-today/master/Docs/screenshot-today.png&quot; alt=&quot;今日截图&quot;&gt;&lt;/p&gt;

&lt;h4&gt;多城市切换&lt;/h4&gt;

&lt;p&gt;支持杭州、天津、重庆、成都、郑州、兰州、东莞、青岛、苏州、乌鲁木齐、瑞安、佛山、深圳、中山、太原、惠州、武汉、南昌、许昌、开封、邯郸、焦作。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/JohnWong/bus-today/master/Docs/screenshot-city.png&quot; alt=&quot;城市截图&quot;&gt;&lt;/p&gt;

&lt;h4&gt;公交线路收藏搜索&lt;/h4&gt;

&lt;p&gt;支持公交线路搜索和收藏，快速找到您所关注的公交线路。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/JohnWong/bus-today/master/Docs/screenshot-main.png&quot; alt=&quot;线路收藏&quot;&gt;&lt;/p&gt;

&lt;h4&gt;公交线路&lt;/h4&gt;

&lt;p&gt;实时公交信息展示，简洁明了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/JohnWong/bus-today/master/Docs/screenshot-line.png&quot; alt=&quot;公交线路&quot;&gt;&lt;/p&gt;

&lt;h4&gt;公交站点&lt;/h4&gt;

&lt;p&gt;根据站点查询公交，方便了解附近公交。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/JohnWong/bus-today/master/Docs/screenshot-stop.png&quot; alt=&quot;公交线路&quot;&gt;&lt;/p&gt;

&lt;h4&gt;下载&lt;/h4&gt;

&lt;p&gt;暂时没有Apple开发者账号，不能发到App Store。仅支持越狱后下载安装。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/JohnWong/bus-today/releases/download/1.1/BusRider.ipa&quot;&gt;BusRider.ipa v1.1&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Homepage&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/JohnWong/bus-today&quot;&gt;https://github.com/JohnWong/bus-today&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Stastics&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;2014-12-03&lt;/code&gt; ~ &lt;code&gt;2015-01-22&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;共计55个commit。&lt;/p&gt;
</description>
        <pubDate>Thu, 05 Feb 2015 00:00:00 +0800</pubDate>
        <link>/showcase/2015/02/05/bus-today.html</link>
        <guid isPermaLink="true">/showcase/2015/02/05/bus-today.html</guid>
        
        
        <category>showcase</category>
        
      </item>
    
      <item>
        <title>使用FontForge进行设计</title>
        <description>&lt;h1&gt;&lt;img src=&quot;/images/2015-02-04-design-with-fontforge-logo.png&quot; alt=&quot;FontForge&quot;&gt; FontForge&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;http://fontforge.github.io/&quot;&gt;FontForge&lt;/a&gt;是一个易于使用，支持多平台的字体设计软件，支持很多字体格式。它是自由开源软件。起初它是由George Williams创造的，目前由&lt;a href=&quot;https://github.com/orgs/fontforge/people&quot;&gt;Github社区&lt;/a&gt;来维护。&lt;/p&gt;

&lt;p&gt;由于开始研究IconFont，接触到了FontForge这个工具。为了更好地学习这个工具，并且能同时帮助到一些字体设计师，我开始翻译官网的帮助文档。努力做到每天一次commit，最终坚持下来顺利完成。在这个过程中除了学习到FontForge的用法外，还学到了字体设计的不少知识，很有意思。&lt;/p&gt;

&lt;p&gt;除了翻译中文外，我还做了网站语言切换的功能。以前网站首页是所有章节的目录，不同语言的章节混排在一起。我试着学习了Jekyll用到的Liquid语法，做出了不同语言的目录。并且在目录的头部添加了符合原有风格的语言切换链接。&lt;/p&gt;

&lt;p&gt;试着提了Pull Request，一位FontForge的成员Merge了PR，并留言说“WOW!!”，让我觉得倍感欣慰。不久后我被邀请加入项目，帮忙打理一些的事情。&lt;/p&gt;

&lt;h4&gt;Show&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://designwithfontforge.com/zh-CN/index.html&quot;&gt;http://designwithfontforge.com/zh-CN/index.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2015-02-04-design-with-fontforge-screenshot.jpg&quot; alt=&quot;FontForge&quot;&gt;&lt;/p&gt;

&lt;h4&gt;Homepage&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/fontforge/designwithfontforge.com&quot;&gt;https://github.com/fontforge/designwithfontforge.com&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Stastics&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;2014-10-16&lt;/code&gt; ~ &lt;code&gt;2014-11-25&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;共计48个commit。&lt;/p&gt;
</description>
        <pubDate>Wed, 04 Feb 2015 00:00:00 +0800</pubDate>
        <link>/showcase/2015/02/04/design-with-fontforge.html</link>
        <guid isPermaLink="true">/showcase/2015/02/04/design-with-fontforge.html</guid>
        
        
        <category>showcase</category>
        
      </item>
    
      <item>
        <title>iOS8定位适配</title>
        <description>&lt;p&gt;iOS8 beta版发布后淘点点尝试适配，其中遇到的一个主要的问题是无法定位，做了一些适配后后能够正常定位。iOS8正式版定位方面没有变动，依然需要做适配。iOS8对定位的改动，基本思路就是将定位细分为Always和WhenInUse两类，要求开发者说明使用定位的用途并酌情使用。此举意在防止定位信息滥用，至于作用就仁者见仁智者见智了。&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;更新：&lt;br&gt;
当使用iOS SDK 8，并且iOS设备或模拟器也是iOS8时，无法定位需要做适配。其他情况下不做适配也可以正常工作。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2&gt;定位变更&lt;/h2&gt;

&lt;p&gt;iOS8的变更包括：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;状态栏图标&lt;/li&gt;
&lt;li&gt;定位服务设置&lt;/li&gt;
&lt;li&gt;定位授权&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;想要全面了解的同学可以学习WWDC的&lt;code&gt;What&amp;#39;s New in Core Location&lt;/code&gt;一节。这里我们主要介绍定位授权。&lt;/p&gt;

&lt;p&gt;定位授权在iOS8中细分为Always和WhenInUse。如下表，定位可以细分为5类。前三个前台更新，属于Continuous Updates。后两个后台更新，属于Location Monitoring。Always授权可以使用这5类定位，而WhenInUse可以使用Continuous Updates，也就是前三个。&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Location&lt;/th&gt;
&lt;th style=&quot;text-align: center&quot;&gt;Always&lt;/th&gt;
&lt;th style=&quot;text-align: right&quot;&gt;WhenInUse&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Location&lt;/td&gt;
&lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
&lt;td style=&quot;text-align: right&quot;&gt;Yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Background location&lt;/td&gt;
&lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
&lt;td style=&quot;text-align: right&quot;&gt;Yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ranging&lt;/td&gt;
&lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
&lt;td style=&quot;text-align: right&quot;&gt;Yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Region monitoring&lt;/td&gt;
&lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
&lt;td style=&quot;text-align: right&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Significant location changes&lt;/td&gt;
&lt;td style=&quot;text-align: center&quot;&gt;Yes&lt;/td&gt;
&lt;td style=&quot;text-align: right&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;iOS8要求应用如果使用定位，需要告诉用户使用的原因。描述放在应用的Info.plist中，当然也可能是其他文件名，取决于项目中的定义。两个授权的key分别为：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;NSLocationAlwaysUsageDescription&lt;/li&gt;
&lt;li&gt;NSLocationWhenInUseUsageDescription&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;看起来Always授权涵盖了WhenInUse授权，使用Always授权可以一劳永逸了。但是如果应用被授予了Always授权，几天后可能需要再次向用户请求授权。这样是为了让应用按需申请授权，开发者可能需要权衡。&lt;/p&gt;

&lt;p&gt;之前定位授权获取发生在应用使用定位的时候，开发者不需要显式地请求。现在则需要显式地请求授权。两个授权对应的方法在类&lt;code&gt;CLLocationManager&lt;/code&gt;中，分别为：&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objective-c&quot; data-lang=&quot;objective-c&quot;&gt;&lt;span class=&quot;p&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;requestAlwaysAuthorization&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__OSX_AVAILABLE_STARTING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__MAC_NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__IPHONE_8_0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;requestWhenInUseAuthorization&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__OSX_AVAILABLE_STARTING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__MAC_NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__IPHONE_8_0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;如何适配&lt;/h2&gt;

&lt;h3&gt;1. 添加定位使用描述&lt;/h3&gt;

&lt;p&gt;在Info.plist中添加应用准备使用的定位授权，例如&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;key&amp;gt;&lt;/span&gt;NSLocationAlwaysUsageDescription&lt;span class=&quot;nt&quot;&gt;&amp;lt;/key&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;string&amp;gt;&lt;/span&gt;淘点点将获取您的位置，为您提供更精准的餐饮服务&lt;span class=&quot;nt&quot;&gt;&amp;lt;/string&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;2. 检测并请求授权&lt;/h3&gt;

&lt;p&gt;在调用&lt;code&gt;CLLocationManager&lt;/code&gt;的&lt;code&gt;startUpdatingLocation&lt;/code&gt;前请求授权。首先为了兼容老版本，需要用宏定义在老版本中屏蔽相关代码。然后检测Info.plist中定义授权的描述，根据存的授权的描述决定申请哪个定位授权。以下代码为墨昕编写。&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objective-c&quot; data-lang=&quot;objective-c&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#if __IPHONE_OS_VERSION_MAX_ALLOWED &amp;gt; __IPHONE_7_1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;floor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NSFoundationVersionNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NSFoundationVersionNumber_iOS_7_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;CLLocationManager&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authorizationStatus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kCLAuthorizationStatusNotDetermined&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hasAlwaysKey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSBundle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mainBundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;objectForInfoDictionaryKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&amp;quot;NSLocationAlwaysUsageDescription&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;BOOL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hasWhenInUseKey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSBundle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mainBundle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;objectForInfoDictionaryKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&amp;quot;NSLocationWhenInUseUsageDescription&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasAlwaysKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locationManager&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestAlwaysAuthorization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasWhenInUseKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locationManager&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requestWhenInUseAuthorization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;NSAssert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hasAlwaysKey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hasWhenInUseKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;@&amp;quot;moxin.xt:add NSLocationWhenInUseUsageDescription or NSLocationAlwaysUsageDescription to your info.plist&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#endif&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;同时建议其他iOS团队写好对用户授权的描述，更多信息参考&lt;a href=&quot;http://www.cocoachina.com/design/20140414/8151.html&quot;&gt;在正确的情境中向用户获取iOS权限&lt;/a&gt;&lt;/p&gt;

&lt;h2&gt;Refer&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://developer.apple.com/videos/wwdc/2014/&quot;&gt;WWDC 2014&lt;/a&gt; What&amp;#39;s New in Core Location一节&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/24062509/ios-8-location-services-not-working&quot;&gt;Stack Overflow&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/index.html&quot;&gt;CoreLocation Framework Reference&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 22 Sep 2014 00:00:00 +0800</pubDate>
        <link>/mobile/2014/09/22/core-location-in-ios8.html</link>
        <guid isPermaLink="true">/mobile/2014/09/22/core-location-in-ios8.html</guid>
        
        
        <category>mobile</category>
        
      </item>
    
      <item>
        <title>用FauxPas找到潜在Bug</title>
        <description>&lt;p&gt;Faux Pas是一个Xcode辅助工具，检查iOS或者Mac项目，找到潜在bug，以及可维护性和风格问题。提供了92条规则可供挑选，支持GUI和CLI。目前发布了beta版，提供30天试用。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://fauxpasapp.com/&quot;&gt;Faux Pas Homepage&lt;/a&gt;
&lt;a href=&quot;http://fauxpasapp.com/try/&quot;&gt;Faux Pas Donwload&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;亲身试用后，发现了项目中的多处问题。一些需要手动查找的问题，在这里都得到了检查。同时也提供了代码风格的建议和一些细节的优化建议。&lt;/p&gt;

&lt;h2&gt;功能&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;控制潜在bug&lt;/li&gt;
&lt;li&gt;查找资源文件错误&lt;/li&gt;
&lt;li&gt;查找本地化错误&lt;/li&gt;
&lt;li&gt;发现版本控制错误&lt;/li&gt;
&lt;li&gt;学习和实施最佳实践&lt;/li&gt;
&lt;li&gt;实施代码风格&lt;/li&gt;
&lt;li&gt;代码审查清单&lt;/li&gt;
&lt;li&gt;92条规则可供挑选&lt;/li&gt;
&lt;li&gt;提供GUI或者CLI&lt;/li&gt;
&lt;li&gt;在Xcode构建时运行&lt;/li&gt;
&lt;li&gt;连接外部工具，支持导出结果和自定义脚本&lt;/li&gt;
&lt;li&gt;按标签选取规则 保存在JSON配置文件中&lt;/li&gt;
&lt;li&gt;更改打开代码的编辑器&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;使用方法&lt;/h2&gt;

&lt;h3&gt;GUI&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;打开FauxPas&lt;/li&gt;
&lt;li&gt;选择或者排除一些规则&lt;/li&gt;
&lt;li&gt;Start Checking&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;CLI&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;打开FauxPas&lt;/li&gt;
&lt;li&gt;菜单栏Faux Pas &amp;gt; Install CLI Tools…&lt;/li&gt;
&lt;li&gt;shell&amp;gt; fauxpas -t iCoupon check iCoupon.xcodeproj/&lt;/li&gt;
&lt;li&gt;可以输出不同格式、挑选检查规则等，参见帮助，例如查找重复资源&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt; fauxpas --onlyRules UnusedResource -o json check MyProject.xcodeproj
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Xcode build时检查&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;确保CLI安装&lt;/li&gt;
&lt;li&gt;在Xcode项目的target中新增&amp;quot;Run Script&amp;quot; build phase&lt;/li&gt;
&lt;li&gt;添加如下脚本，build时会执行FauxPas检查&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[[ ${FAUXPAS_SKIP} == 1 ]] &amp;amp;&amp;amp; exit 0

 FAUXPAS_PATH=&amp;quot;/usr/local/bin/fauxpas&amp;quot;
 if [[ -f &amp;quot;${FAUXPAS_PATH}&amp;quot; ]]; then
   &amp;quot;${FAUXPAS_PATH}&amp;quot; check-xcode
 else
   echo &amp;quot;warning: Faux Pas was not found at &amp;#39;${FAUXPAS_PATH}&amp;#39;&amp;quot;
 fi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;建议不使用这种方式，会额外增加build时间。&lt;/p&gt;

&lt;h3&gt;Xcode中手动执行&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;确保CLI安装&lt;/li&gt;
&lt;li&gt;项目中创建Aggregate类型target&lt;/li&gt;
&lt;li&gt;在该target下新增&amp;quot;Run Script&amp;quot; build phase&lt;/li&gt;
&lt;li&gt;添加如下脚本，运行该target时会执行FauxPas检查&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt; /usr/local/bin/fauxpas -o xcode check &amp;quot;PROJECT_NAME.xcodeproj&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;导出结果&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;GUI中点击Export Diagnostics，选择格式&lt;/li&gt;
&lt;li&gt;CLI下-o参数，可选human、json、plist、xcode&lt;/li&gt;
&lt;li&gt;导出结果可以用其他工具处理&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;实战&lt;/h2&gt;

&lt;p&gt;使用GUI扫描了项目，发现了许多不少有价值的问题，值得我们学习。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;编译参数的有益建议，比如-DNDEBUG&lt;/li&gt;
&lt;li&gt;多处图片缺少和图片重复&lt;/li&gt;
&lt;li&gt;非retian与retina图尺寸不是2倍&lt;/li&gt;
&lt;li&gt;没有前缀或者前缀与SDK冲突，建议至少三字符长度&lt;/li&gt;
&lt;li&gt;Retain Delegate&lt;/li&gt;
&lt;li&gt;重载或者调用一些限制的系统方法&lt;/li&gt;
&lt;li&gt;缺少获取授权的描述&lt;/li&gt;
&lt;li&gt;Category方法冲突&lt;/li&gt;
&lt;li&gt;未使用的Error值，建议不关心Error时参数传入NULL&lt;/li&gt;
&lt;li&gt;设置delegate或者datasource为self时需要在dealloc中置为空&lt;/li&gt;
&lt;li&gt;对指针和0做比较&lt;/li&gt;
&lt;li&gt;obj ? obj : other obj将会评估2次。而obj ?: other会评估一次&lt;/li&gt;
&lt;li&gt;界面字符串缺少本地化，我们的项目实际不需要&lt;/li&gt;
&lt;li&gt;修改传入参数的值&lt;/li&gt;
&lt;li&gt;model类包含的对象的@property建议用copy，防止非setter的修改&lt;/li&gt;
&lt;li&gt;pch中引用过的头文件再次引用多余&lt;/li&gt;
&lt;li&gt;VCS建议，例如建议Xcode workspace data不忽略&lt;/li&gt;
&lt;li&gt;在init or dealloc不要使用setter。&lt;/li&gt;
&lt;li&gt;不和习惯的getter。使用something而非getSomething&lt;/li&gt;
&lt;li&gt;旧语法，例如+[NSNumber numberWithFloat:], -[NSDictionary objectForKey:]。建议转换为现代语法Edit → Refactor → Convert To Modern Objective-C Syntax&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Fri, 29 Aug 2014 00:00:00 +0800</pubDate>
        <link>/mobile/2014/08/29/using-fauxpas.html</link>
        <guid isPermaLink="true">/mobile/2014/08/29/using-fauxpas.html</guid>
        
        
        <category>mobile</category>
        
      </item>
    
      <item>
        <title>苹果的一些坑</title>
        <description>&lt;p&gt;嗯嗯，最近踩坑不少，总结一下：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;OSX中文系统网络代理，如果设置了排除的网址，保存后会被系统将分隔符逗号改为顿号导致失效。所以我一直在用英文版。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;iOS地图SDK中，MKAnnotationView的centerOffset属性设置无效，是一个bug。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;iOS8槽点更多。模拟器点击关于本机之后有可能卡死。5s进入设置页点进比较深的页面，然后快速双击后退。页面内容后退两次，但是导航栏只后退了一次。AppStore闪退过。AppStore点击搜索后自动变成取消搜索的状态。wifi设置bug很多，经常变成怪异的样子。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Safari中有的图片会缺少一部分，试过Photoshop导出图片的各种选项后发现，导出时勾选连续、使用嵌入颜色配置才会显示正确。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Wed, 04 Jun 2014 00:00:00 +0800</pubDate>
        <link>/past/2014/06/04/bugs-by-apple.html</link>
        <guid isPermaLink="true">/past/2014/06/04/bugs-by-apple.html</guid>
        
        
        <category>past</category>
        
      </item>
    
      <item>
        <title>人生第一份工作</title>
        <description>&lt;p&gt;上周五入职了，开始人生的第一份工作。时隔五年后再次来到杭州，心情不一样了。本科怕工作了没时间玩，去北京晚了好多天好多地方。怕没时间去南方这么远，把江沪浙一代逛遍了。万万没想到读研去北京了，工作去杭州了。五年前总想着玩，游遍全国走向世界，现在则时刻记着肩上的担子。&lt;/p&gt;

&lt;p&gt;无聊消遣做做iOS玩，没想到成为以后的技术方向。玩跟工作毕竟不一样，要学的东西很多，我必须要加倍努力。师兄人很好，也挺关心我，团队氛围也很好。能坑自己的，恐怕只有自己。接下来就看自己能不能成为自己想成为的样子。&lt;/p&gt;
</description>
        <pubDate>Tue, 22 Apr 2014 00:00:00 +0800</pubDate>
        <link>/past/2014/04/22/first-job-in-my-life.html</link>
        <guid isPermaLink="true">/past/2014/04/22/first-job-in-my-life.html</guid>
        
        
        <category>past</category>
        
      </item>
    
      <item>
        <title>扒一扒北邮的安全问题[5]-教务账号外泄到鲜次元</title>
        <description>&lt;h4&gt;漏洞类型：&lt;/h4&gt;

&lt;p&gt;SQL注入&lt;/p&gt;

&lt;h4&gt;相关网站&lt;/h4&gt;

&lt;p&gt;鲜次元&lt;/p&gt;

&lt;h4&gt;问题描述&lt;/h4&gt;

&lt;p&gt;鲜次元网站存在sql诸如漏洞，其数据库存储这部分同学的教务账号&lt;/p&gt;

&lt;h4&gt;漏洞详情&lt;/h4&gt;

&lt;p&gt;之前就发现鲜次元网站存在sql注入漏洞，搞到了mysql的root账户加密后的密码，一直无法解密。今天闲来无事进一步测试，发现其中有一个数据库名为a1015151118，里面的user表存储这用户信息，但是存在password、xuehao、byrpassword和jwcpassword。惊呆了，莫非包含了学号、北邮人密码和教务处密码。用户的北邮人账号不清楚，所以北邮人密码也用不上，就试试教务处网站。 
password字段是加密的但是有部分可以简单解出来。学号已经有了，jwcpassword字段好多是空的，就用password字段解密后作为教务处密码。试了几个账号，有一个成功了，而且还是朝鲜族美女。后面又成功登录了几个账号，懒得继续试下去了。 &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-06-security-in-bupt-05-01.png&quot; alt=&quot;2014-04-06-security-in-bupt-05-01.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;PS. 后来了解到鲜次元为一个校内活动提供数据库支持但是活动结束后没及时清理数据才会有学生信息。没想到现在鲜次元独立网站已经关掉，切换到新浪博客上也许久没更新了，应该是阵亡了，挺可惜的。&lt;/p&gt;

&lt;h4&gt;原帖&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://bbs.byr.cn/#!article/WWWTechnology/24483&quot;&gt;http://bbs.byr.cn/#!article/WWWTechnology/24483&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Sun, 06 Apr 2014 00:00:00 +0800</pubDate>
        <link>/security/2014/04/06/security-in-bupt-05.html</link>
        <guid isPermaLink="true">/security/2014/04/06/security-in-bupt-05.html</guid>
        
        
        <category>security</category>
        
      </item>
    
      <item>
        <title>扒一扒北邮的安全问题[4]-一大波访问控制问题</title>
        <description>&lt;h4&gt;漏洞类型：&lt;/h4&gt;

&lt;p&gt;弱口令/无访问控制/代码备份&lt;/p&gt;

&lt;h4&gt;相关网站&lt;/h4&gt;

&lt;p&gt;内网多个ip&lt;/p&gt;

&lt;h4&gt;问题描述&lt;/h4&gt;

&lt;p&gt;文件、数据库、代码、phpMyAdmin等无法访问控制或者弱口令&lt;/p&gt;

&lt;h4&gt;漏洞详情&lt;/h4&gt;

&lt;p&gt;一票Web容器没做访问控制，同时给了列目录权限。这样就等于自己的各种资源分享给了所有人啊，这应该不是初衷吧。 &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-04-01.jpg&quot; alt=&quot;/images/2014-04-02-security-in-bupt-04-01.jpg&quot;&gt;&lt;/p&gt;

&lt;p&gt;然后还有一票phpMyAdmin没有访问控制，或者弱口令。据说拿到MySql的远程登录权限甚至能上传程序控制整个主机。 &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-04-02.jpg&quot; alt=&quot;/images/2014-04-02-security-in-bupt-04-02.jpg&quot;&gt;&lt;/p&gt;

&lt;p&gt;然后是使用默认密码的版本控制程序、惠普打印机、戴尔服务器、中兴4G LTE CPE设备、TP-LINK路由器。这个打印机还有Telnet功能，能远程打印。至于有没有打印出来不知道了。 &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-04-03.png&quot; alt=&quot;/images/2014-04-02-security-in-bupt-04-03.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-04-04.png&quot; alt=&quot;/images/2014-04-02-security-in-bupt-04-04.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-04-05.png&quot; alt=&quot;/images/2014-04-02-security-in-bupt-04-05.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-04-06.png&quot; alt=&quot;/images/2014-04-02-security-in-bupt-04-06.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-04-07.png&quot; alt=&quot;/images/2014-04-02-security-in-bupt-04-07.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;最后是一个智慧油田系统。数据库没有使用弱口令，但是把源代码打包放到Web容器里，很容易从中找到数据库配置。管理员密码还是明文存储的。。。 &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-04-08.png&quot; alt=&quot;/images/2014-04-02-security-in-bupt-04-08.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;总结一下：使用web容器最好不要给列目录的权限；不使用弱口令和默认密码；代码不要打包后放到容器中。 
PS. 我尽量隐藏IP等细节了。如果不小心放出了请即使私信我。 &lt;/p&gt;

&lt;h4&gt;原帖&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://bbs.byr.cn/#!article/WWWTechnology/24398&quot;&gt;http://bbs.byr.cn/#!article/WWWTechnology/24398&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 02 Apr 2014 00:00:00 +0800</pubDate>
        <link>/security/2014/04/02/security-in-bupt-04.html</link>
        <guid isPermaLink="true">/security/2014/04/02/security-in-bupt-04.html</guid>
        
        
        <category>security</category>
        
      </item>
    
      <item>
        <title>扒一扒北邮的安全问题[3]-摄像头这么多</title>
        <description>&lt;h4&gt;漏洞类型：&lt;/h4&gt;

&lt;p&gt;弱口令/默认密码&lt;/p&gt;

&lt;h4&gt;相关网站&lt;/h4&gt;

&lt;p&gt;校园内网某实验室&lt;/p&gt;

&lt;h4&gt;问题描述&lt;/h4&gt;

&lt;p&gt;海康威视Web登录界面使用默认密码 &lt;/p&gt;

&lt;h4&gt;漏洞详情&lt;/h4&gt;

&lt;p&gt;之前发现的问题，扫到某个ip，发现开放80端口。打开发现是摄像头的Web登录界面，好高端啊。 
Google得到这个产品的默认密码，居然可以登录。后来发现乌云上也有人报过这个漏洞，由于主要原因是用户没有修改登录密码，因此被厂商忽略了。12个网络摄像头，好高端啊。至于哪个实验室的不太清楚。该实验室还有另外一个摄像头，这里就懒得截图了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-02-security-in-bupt-03-01.png&quot; alt=&quot;2014-04-02-security-in-bupt-03-01.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;PS. 类似默认密码的海康威视的设备可以通过神器&lt;a href=&quot;http://www.zoomeye.org/&quot;&gt;钟馗之眼&lt;/a&gt;找到更多。&lt;/p&gt;

&lt;h4&gt;原帖&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://bbs.byr.cn/#!article/WWWTechnology/24327&quot;&gt;http://bbs.byr.cn/#!article/WWWTechnology/24327&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 02 Apr 2014 00:00:00 +0800</pubDate>
        <link>/security/2014/04/02/security-in-bupt-03.html</link>
        <guid isPermaLink="true">/security/2014/04/02/security-in-bupt-03.html</guid>
        
        
        <category>security</category>
        
      </item>
    
      <item>
        <title>扒一扒北邮的安全问题[2]-如何查看女神照片</title>
        <description>&lt;h4&gt;漏洞类型：&lt;/h4&gt;

&lt;p&gt;SQL注入&lt;/p&gt;

&lt;h4&gt;相关网站&lt;/h4&gt;

&lt;p&gt;研究生信息数字化管理系统 &lt;/p&gt;

&lt;h4&gt;问题描述&lt;/h4&gt;

&lt;p&gt;SQL注入漏洞导致部分学生账号和信息泄漏 &lt;/p&gt;

&lt;h4&gt;漏洞详情&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://yjxt.bupt.edu.cn&quot;&gt;http://yjxt.bupt.edu.cn&lt;/a&gt;这个网站存在一个SQL注入漏洞。安全起见存在漏洞的地址就不贴出来了。同时欢迎有关老师私信索取地址，及时修复漏洞。接下来的事情很简单了，就是放到SQLmap里看看有什么有用的信息。表很多，没时间仔细找，暂时发现了部分学生学号和身份证号码等信息。这里就列出其中一个，并将学号、姓名、生日、身份证号打码。 &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-01-security-in-bupt-02-01.png&quot; alt=&quot;2014-04-01-security-in-bupt-02-01&quot;&gt;&lt;/p&gt;

&lt;p&gt;那么接下来，如果有的同学一直在使用默认密码，也就是生日八位数字，那么意味着可以登录这个同学的账号。已经毕业的学生账号已经锁定，所以影响的是在校生。如果刚好是11级的，那么你甚至可以在照片信息核对这里看到女神的照片，而且是读研前与读研后的对比哦。 &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2014-04-01-security-in-bupt-02-02.png&quot; alt=&quot;2014-04-01-security-in-bupt-02-02&quot;&gt;&lt;/p&gt;

&lt;p&gt;外包那边的开发人员找我帮忙调试，目前已经修复该漏洞。所以公布漏洞地址http://yjxt.bupt.edu.cn/Open/ExpertInfo.aspx?zjbh=2010810770&lt;/p&gt;

&lt;h4&gt;原帖&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://bbs.byr.cn/#!article/WWWTechnology/24215&quot;&gt;http://bbs.byr.cn/#!article/WWWTechnology/24215&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 01 Apr 2014 00:00:00 +0800</pubDate>
        <link>/security/2014/04/01/security-in-bupt-02.html</link>
        <guid isPermaLink="true">/security/2014/04/01/security-in-bupt-02.html</guid>
        
        
        <category>security</category>
        
      </item>
    
  </channel>
</rss>
